<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Dynamic Plot from Available Methods</title>
    <style>
        /* Allow the plot to overflow so nothing is clipped */
        #plot-container {
            overflow: visible;
            margin-top: 20px;
        }
    </style>
</head>
<body>

<h1>Select a Plot Method</h1>

<select id="plotSelect">
    <!-- Will be populated dynamically from /available_plots -->
</select>
<button id="fetch-plot-button">Show Plot</button>

<div id="plot-container"></div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const plotSelect = document.getElementById('plotSelect');
    const container = document.getElementById('plot-container');

        // 1. Fetch list of available plots when page loads
        fetch('http://localhost:5000/available_plots')
            .then(response => response.json())
            .then(plotMethods => {
                // Populate the dropdown
                plotMethods.forEach(method => {
                    const option = document.createElement('option');
                    option.value = method;
                    option.textContent = method;
                    plotSelect.appendChild(option);
                });
            })
            .catch(err => console.error("Error fetching available plots:", err));

        // 2. When "Show Plot" is clicked, fetch the selected plot
    document.getElementById('fetch-plot-button').addEventListener('click', () => {
        const selectedMethod = plotSelect.value;
        const url = `http://localhost:5000/plot?method_name=${encodeURIComponent(selectedMethod)}`;

        // Clear any old plot
        container.innerHTML = '';

        // Fetch new plot HTML
        fetch(url)
            .then(response => response.text())
            .then(plotHTML => {
                // Insert the plot HTML (including <script> tags)
                const range = document.createRange();
                const frag = range.createContextualFragment(plotHTML);
                container.appendChild(frag);
            })
            .catch(err => console.error("Error fetching plot:", err));
    });
    });
</script>

</body>
</html>
